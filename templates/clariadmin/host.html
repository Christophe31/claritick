<?xml version='1.0' encoding='utf-8'?>
{% extends "base.html" %}
    {% block extrastyle %}
    {% endblock %}
{% block extrajs %}
<script type="text/javascript" src="/adm_media/js/admin/RelatedObjectLookups.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}js/clariadmin.js"></script>
<script type="text/javascript" charset="utf-8">
    dojo.require('dijit.form.MultiSelect');
    dojo.require('dijit.form.CheckBox');
    function handle_data(data){
        tab=dojo.byId("extra_fields");
        tab.innerHTML=data;
        dojo.parser.parse(tab);
    }
    function typeChanged(select_box)
    {
        dojo.byId("extra_fieldset").classList.remove("dijitHidden");
        dojo.xhrGet({
            url:"{% url clariadmin.views.ajax_extra_fields_form -1 %}".replace('-1',select_box.item.value?select_box.item.value:-1),
            load:handle_data
            });
    }

function confirmation_callback(myBool, form_id){
    if(myBool){
        postwith(
        {delete:"true"},dojo.byId(form_id));
        }
}
</script>
{%endblock%}
{% block content %}

<form id="the_form" method="POST">
    {% csrf_token %}
    <fieldset style="float:left;">
        <table class="clariadmin_form">
            {% for field in form %}
                <tr>
                    <th>{{ field.label_tag }}</th>
                    <td>{{ field }}</td>
                    <td>{{field.errors}}</td>
                    <td>{%if perms.common.add_client and field.name == 'site' or perms.clariadmin.add_supplier and field.name == 'supplier' or perms.clariadmin.add_operatingsystem and field.name == 'os' or perms.clariadmin.add_hosttype and field.name == 'type' %}
                        <a id='add_id_{{field.name}}' class="add-another" href="/admin/clariadmin/{{field.name}}/add/"onclick="return showAddAnotherPopup(this);">
                            <img width="10" height="10" alt="Ajouter un autre" src="/adm_media/img/admin/icon_addlink.gif"></a>
                        {%endif%}</td>
                </tr>
            {%endfor%}
        </table>
    </fieldset>

    <fieldset id="extra_fieldset" {% if not additionnal_fields.fields %}class="dijitHidden"{% endif %}>
        <table id="extra_fields" class="clariadmin_form">
        {% if additionnal_fields.fields %}
            {{ additionnal_fields }}
        {% endif %}
        </table>
    </fieldset>

    <hr />
    <div id="save_buttons">
        <button dojoType="dijit.form.Button" iconClass="dijitEditorIcon dijitEditorIconSave" type="submit" name="submit_button" value="save">Enregistrer</button>
        <button dojoType="dijit.form.Button" iconClass="dijitEditorIcon dijitEditorIconSave" type="submit" name="submit_button" value="new">Enregistrer et ajouter un nouveau</button>
        <button dojoType="dijit.form.Button" iconClass="dijitEditorIcon dijitEditorIconSave" type="submit" name="submit_button" value="return">Enregistrer et retourner à la liste</button>
        {%if host%}<button dojoType="dijit.form.Button" onclick='confirmDialog("Supression de l hote", "Êtes vous sûr de vouloir supprimer cette machine de la base?", confirmation_callback, "the_form")' iconClass="dijitEditorIcon dijitEditorIconDelete" type="action" value="true" class="default">Suprimer</button>{%endif%}
    </div>
</div>
</form>
{% endblock %}
